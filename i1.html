<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manifest Display</title>
    <style>
        /* Add any desired styles here */
    </style>
</head>

<body>

    <h1 id="pageTitle">Select a theme</h1>

    <select id="folderDropdown" onchange="loadFiles()">
        <!-- This dropdown will be populated using JavaScript -->
        <option value="">Select a theme...</option>
    </select>

    <div id="displayContainer">
        <!-- The extracted content will be displayed here -->
    </div>

    <script>
/*
        const patterns = {
            "Engage": /Engage:\s*([\s\S]*?)(?=\n\s*Set the Objective:)/,
            "Set the Objective": /Set the Objective:\s*([\s\S]*?)(?=\n\s*Highlight the Value:)/,
            "Highlight the Value": /Highlight the Value:\s*([\s\S]*?)(?=\nBiblical Exploration:)/,
            "Reiterate the Question": /Reiterate the Question:\s*([\s\S]*?)(?=\n\s*Reading the Passage:)/,
            "Reading the Passage": /Reading the Passage:\s*([\s\S]*?)(?=\n\s*Clarification:)/,
            "Clarification": /Clarification:\s*([\s\S]*?)(?=\n\s*Illustration:)/,
            "Illustration": /Illustration:\s*([\s\S]*?)(?=\n\s*Application:)/,
            "Application": /Application:\s*([\s\S]*?)(?=\n\s*Transition:)/,
            "Transition": /Transition:\s*([\s\S]*?)(?=\n\s*Reiterate the Question:)/,
            "Second Reiterate the Question": /Transition:.*?Reiterate the Question:\s*([\s\S]*?)(?=\n\s*Reading the Passage:)/s,
            "Recap": /Recap:\s*([\s\S]*?)(?=\n\s*Call to Action:)/,
            "Call to Action": /Call to Action:\s*([\s\S]*?)(?=\n\s*Highlight Benefits:)/,
            "Highlight Benefits": /Highlight Benefits:\s*([\s\S]*?)(?=\n\s*Closing Thought:)/,
            "Closing Thought": /Closing Thought:\s*([\s\S]*?)(?=\nPhrase to sum up the talk:)/,
            "Phrase to sum up the talk": /Phrase to sum up the talk:\s*"([\s\S]*?)"/
        };
*/
const patterns = {
    "Engage": /Engage:\s*([\s\S]+?)(?=\s*Set the Objective:)/,
    "Set the Objective": /Set the Objective:\s*([\s\S]+?)(?=\s*Highlight the Value:)/,
    // ... (continue with the rest of the patterns, making similar adjustments)
};

        window.onload = function () {
            fetch('manifest.json')
                .then(response => response.json())
                .then(data => {
                    const dropdown = document.getElementById('folderDropdown');
                    Object.keys(data.folders).forEach(folder => {
                        const option = document.createElement('option');
                        option.value = folder;
                        option.textContent = folder;
                        dropdown.appendChild(option);
                    });
                });
        };

        function loadFiles() {
                const theme = document.getElementById('folderDropdown').value;
                if (!theme) return;
            
                document.getElementById('pageTitle').textContent = theme;
                const container = document.getElementById('displayContainer');
                container.innerHTML = ''; // Clear previous content
            
                fetch('manifest.json')
                    .then(response => response.json())
                    .then(data => {
                        data.folders[theme].forEach(fileName => {
                            fetch(fileName)
                                .then(response => response.text())
                                .then(content => {
                                    console.log(`Content of ${fileName}:`, content); // Log the content for debugging
                                    const extractedSections = extractSections(content);
                                    displayData(extractedSections);
                                });
                        });
                    });
            }


        function extractSections(content) {
            let results = {};
            for (let section in patterns) {
                let match = content.match(patterns[section]);
                results[section] = match ? match[1].trim() : "Not found";
            }
            return results;
        }

        function displayData(extractedSections) {
            const container = document.getElementById('displayContainer');
            Object.keys(patterns).forEach(h2Name => {
                const h2 = document.createElement('h2');
                h2.textContent = h2Name;
                container.appendChild(h2);

                const div = document.createElement('div');
                div.textContent = extractedSections[h2Name];
                container.appendChild(div);
            });
        }

    </script>
</body>

</html>
